# ycsb-summarize
A simple script that exctracts YCSB performance numbers from
[DSI](https://github.com/10gen/dsi) tarballs.

This bash script takes one or more tarballs generated by DSI runs (or,
alternatively,URL's to such tarballs), extracts YCSB
performance data, and outputs that data to stdout as a CSV (comma-separated
values) file that can be easily imported into a spreadsheet.

## Getting started

    $ ./summarize.sh -h
    $ ./summarize.sh file1.tgz https://some.file-store.com/some/path/file2.tgz ...

Each tarball represents a single run.
The script will output the performance numbers in the following format:
`<run-number>,<benchmark>,<metric-name>,<value>`.

To insert additional descriptive fields in the output, use the `-p <prefix>`
option. Your prefix will appear between `<run-number>` and `<prefix>`.
Your prefix may contain commas in order to create multiple fields in
the CSV.

To change the location of directories where tarballs are untarred, use the
`-d <directory>` option.

## How to use the CSV output

1. Import the CSV into a spreadsheet.
2. Use the columns that contain your prefix, benchmark, and metric-name to
   create one "label" per row that is the concatenation of these strings.
   The label will be used to combine the measured values of each run.
3. Create formulas that conditionally combine (e.g. mean, stdev) the values
   based on a filter on the label.

## How it works

The script will create numbered subdirectories under the current
working directory, starting with "1" and extract the tarballs into
these numbered directories in the order you specified. To use a different
directory than the current working directory, use the `-d` option.

**BUG:** There is a bug that causes the script to mix up results if the
numbered subdirectories already exist and already contain files from
previous invocations of this script. Make sure that your working directory
does not have the numbered subdirectories before running the script.

## TODO
* Prevent mixing of results from multiple runs of the script.
* Accomodate DSI runs on local machines and Atlas, which deliver the
actual output directories (not tarball'd).
* Optionally delete untarred files at the end of the script.
* Generalize for output of various DSI benchmarks.
* Automate creation of spreadsheets.
